[{"title":"Packed Sprite Atlas in AssetBundle","authorName":"Alejandro Lopez.","createdDate":"2015-11-19T21:18:31Z","updatedDate":"2017-02-26T02:51:26Z","labels":["Sprite Packer","AssetBundles","Atlas"],"sections":[{"title":"SymptomsÂ ","content":["\n<li>AssetBundles with sprites have a greater size than the expected.</li>\n<li>Atlas is stored twice in AssetBundles</li>\n"]},{"title":"Cause","content":["<span class=\"s1\"><em>Issue</em>&#xA0;#1</span>","Before Unity 5.2.2p4, there was a bug using Sprite Atlas and AssetBundles. Let us consider that you want to create two asset bundles:","\n<li>Three sprites are tagged into an atlas and packed in an AssetBundle. (&quot;art.unity3d&quot;)</li>\n<li>A sprite using the same atlas and packed in a different AssetBundle. (&quot;prefab.unity3d&quot;)</li>\n","When you create the AssetBundles, the &quot;art.prefab&quot; will contain the corresponding sprite vertices, a pointer to the atlas and the atlas texture. The second prefab will also store (duplicate) the atlas texture.","<em>Issue #2:</em>","Another issue is when the user marks one of the sprites to be in another AssetBundle. The other AssetBundle will also contain the atlas image."]},{"title":"Resolution","content":["<em>Issue&#xA0;<em>#</em>1:</em>","\n<li>Update to Unity 5.2.2p4, or the latest Unity version.</li>\n","<em>Issue&#xA0;<em>#</em>2:</em>","\n<li>Sprites packed into the same Atlas needs to be packed in the same AssetBundle.</li>\n","The below image shows two sprites using the same AssetBundle and Packing tag.&#xA0;","<img src=\"/hc/en-us/article_attachments/202318706/spriteDemo2.png\" alt=\"\">&#xA0;","The example below checks if the sprites tagged in the same atlas are packed in different bundles:","public class SpriteChecker <br>{<br>    // This will create a Menu named &quot;Support&quot;, with a sub-menu <br>    // named &quot;SpriteChecker&quot;, in the Editor menu bar.\n    [MenuItem(&quot;Support/SpriteChecker&quot;)]\n    static void CheckSpritesTagsAndBundles () <br>    {<br>        // Get all the GUIDs (identifiers in project) of the Sprites in the Project\n        string[] guids = AssetDatabase.FindAssets (&quot;t:sprite&quot;);<br><br>        // Dictionary to store the tags and bundle names\n        Dictionary&lt;string,string&gt; dict = new Dictionary&lt;string, string&gt;();\n        foreach( string guid in guids) <br>        {\n            string path = AssetDatabase.GUIDToAssetPath(guid);\n            TextureImporter ti = TextureImporter.GetAtPath( path) as TextureImporter;<br><br>            // If the tag is not in the dictionary, add it\n            if (!dict.ContainsKey (ti.spritePackingTag ))\n                dict.Add(ti.spritePackingTag, ti.assetBundleName);\n            else<br>                // If the tag is associated with another bundle name, show an error\n                if (dict[ti.spritePackingTag] != ti.assetBundleName)\n                    Debug.LogWarning(&quot;Sprite : &quot; + ti.assetPath + &quot; should be packed in &quot;+  dict[ti.spritePackingTag] );\n        }<br>    }\n}","&#xA0;"]},{"title":"More Information","content":["<a href=\"http://docs.unity3d.com/Manual/Sprites.html\">http://docs.unity3d.com/Manual/Sprites.html</a>","<a href=\"http://docs.unity3d.com/Manual/AssetBundlesIntro.html\">http://docs.unity3d.com/Manual/AssetBundlesIntro.html</a>"]}]}]