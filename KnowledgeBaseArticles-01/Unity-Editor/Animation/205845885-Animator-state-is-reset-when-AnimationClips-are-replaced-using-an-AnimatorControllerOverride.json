[{"title":"Animator state is reset when AnimationClips are replaced using an AnimatorControllerOverride","authorName":"Alejandro Lopez.","createdDate":"2015-08-14T22:11:45Z","updatedDate":"2017-03-14T02:26:56Z","labels":["AnimatorOverrideController"],"sections":[{"title":"\n\nSymptoms \n\n","content":["\n<li>The state of the Animator gets reset when you change the AnimatorControllerClips at runtime.</li>\n<li>When you try to change the AnimationClip, it does not work the second time that is changed.</li>\n"]},{"title":"Cause","content":["It is expected that the Animator is reset when you change a clip. Unity needs to save the Animator state before replacing the AnimationClip and set it back after it has been replaced, but that feature is not implemented in some versions of Unity. <strong><br></strong>"]},{"title":"Resolution","content":["As a workaround you can use scripting to save and restore the state of the Animator when changing the AnimationClip.<br><br>","void ChangeClip(AnimationClip clip ){<br>    Animator anim = GetComponent&lt;Animator&gt;();&#xA0;\n    AnimatorOverrideController overrideController = <br>        new AnimatorOverrideController();<br>\n    AnimatorStateInfo[] layerInfo = new AnimatorStateInfo[anim.layerCount];\n    for (int i = 0; i &lt; anim.layerCount; i++)\n    {\n        layerInfo[i] = anim.GetCurrentAnimatorStateInfo(i);\n    }\n\n    overrideController.runtimeAnimatorController = anim.runtimeAnimatorController;\n    overrideController[currentClipName] = clip;\n    anim.runtimeAnimatorController = overrideController;\n\n    // Force an update\n    anim.Update(0.0f);\n\n    // Push back state\n    for (int i = 0; i &lt; anim.layerCount; i++)\n    {\n        anim.Play(layerInfo[i].nameHash, i, layerInfo[i].normalizedTime);\n    }\n    currentClipName = clip.name;\n}\n","&#xA0;"]},{"title":"\n\n\n\n\nMore Information\n\n \nPlease also see this Forum post.\n\n \nThis article applies to Unity version 5.1.1f1\n\n\n \n\n\n\n\n","content":[]}]}]